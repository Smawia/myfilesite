{% extends 'base.html' %}

{% load static %}
{% block title %}الرئيسية{% endblock %}

{% block content %}
<style>
    html,
    body,
    main {
        width: 100%;
        height: 100%;
        margin: 0px;
        padding: 0;

    }
    main {
        position: relative;
        margin-bottom: 40px;
        margin-top: 40px;
    }

    #carousel {
        position: relative;
        height: 732px;
        top: 50%;
        transform: translateY(-50%);
        overflow: hidden;
    }

    #carousel div {
        position: absolute;
        transition: transform 400ms, left 400ms, opacity 400ms, z-index 0s;
        opacity: 1;
    }

    #carousel div img {
        width: auto;
        height: 90%;
      /*  max-height: 90%;
        min-height: 90%;*/
        transition: width 400ms;
        -webkit-user-drag: none;
        border-top-right-radius: 10px;
        border-top-left-radius: 10px;
        display: block;
    }

    #carousel .hideLeft .silder-moving,
    #carousel .prevLeftSecond .silder-moving,
    #carousel .prev .silder-moving {
        text-align: left;
        direction: ltr;
        left: 10px;
        /* تأكد من وجود مسافة كافية */
        right: auto;
    }

    #carousel div.hideLeft {
        left: 0%;
        opacity: 0;
        transform: translateY(50%) translateX(-50%);
    }

    #carousel div.hideLeft img {
        width: 200px;
        height: 200px;
    }

    #carousel div.hideRight {
        left: 100%;
        opacity: 0;
        transform: translateY(50%) translateX(-50%);
    }

    #carousel div.hideRight img {
        width: 200px;
    }

    #carousel div.prev {
        z-index: 5;
        left: 30%;
        transform: translateY(50px) translateX(-50%);
        opacity: 0.7;
    }

    #carousel img:hover {
        cursor: default;
    }

    #carousel div.prev img {
        width: 300px;
        height: 300px;
    }

    #carousel div.prevLeftSecond {
        z-index: 4;
        left: 15%;
        transform: translateY(50%) translateX(-50%);
        opacity: 0.2;
    }

    #carousel div.prevLeftSecond img {
        width: 200px;
        height: 200px;
    }

    #carousel div.selected {
        z-index: 10;
        left: 50%;
        transform: translateY(0px) translateX(-50%);
        height: 100%;
    }

    #carousel div.next {
        z-index: 5;
        left: 70%;
        transform: translateY(50px) translateX(-50%);
        opacity: 0.7;
    }

    #carousel div.next img {
        width: 300px;
        height: 300px;

    }

    #carousel .silder-moving {
        background-color: white;
        padding: 10px;
        min-width: 500px;
       /* max-width: 500px; */
        box-sizing: border-box;
        border-bottom-right-radius: 10px;
        border-bottom-left-radius: 10px;
        font-family: 'CodecProRegular';
        width: 658px;
    }
    #carousel .silder-moving span {
        color: #777777;
        font-size: 14px;
    }
    #carousel .silder-moving p {
        color: #333333;
        font-size: 16px;
        font-family: 'CodecProBold';
    }

    #carousel div.nextRightSecond {
        z-index: 4;
        left: 85%;
        transform: translateY(50%) translateX(-50%);
        opacity: 0.2;
    }

    #carousel div.nextRightSecond img {
        width: 200px;
    }

    .arrow-silder {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2rem;
        color: white;
        background-color: rgba(0, 0, 0, 0.5);
        padding: 10px 20px;
        border-radius: 50%;
        cursor: pointer;
        user-select: none;
        transition: background-color 0.3s;
    }

    .arrow-silder:hover {
        background-color: rgba(0, 0, 0, 0.8);
    }

    .left-arrow-silder {
        left: 30%;
    }

    .right-arrow-silder {
        right: 30%;
    }
    .carousel-dots {
        display: flex;
        justify-content: center;
        position: relative;
        top: 20px;
    }
    
    .carousel-dots div {
        width: 10px;
        height: 10px;
        background-color: rgba(0, 0, 0, 0.3);
        border-radius: 50%;
        margin: 0 5px;
       /* cursor: pointer;*/
        transition: background-color 0.3s;
    }
    
    .carousel-dots div.active {
        background-color: rgba(0, 0, 0, 0.8);
    }
    @media (max-width: 574px) {
        main {
            display: none;
        }
        .publications.carousel-title {
            display: none;
        }
    }
    
    @media (min-width: 575px) {
        main {
            display: none;
        }
        .publications.carousel-title {
            display: none;
        }
    }
    
    @media (min-width: 768px) {
        .container.index-articles.hide-in-pc {
            display: none;
        }
        main {
            display: block;
        }
        .publications.carousel-title {
            display: block;
        }
    }
    
    @media (min-width: 992px) {
        .container.index-articles.hide-in-pc {
            display: none;
        }
        main {
            display: block;
        }
        .publications.carousel-title {
            display: block;
        }
    }
</style>
<div class="container spe-show">
    <div class="slider">
        <div class="slides">
            <input type="radio" name="radio-btn" id="radio1">
            <input type="radio" name="radio-btn" id="radio2">
            <input type="radio" name="radio-btn" id="radio3">
            <input type="radio" name="radio-btn" id="radio4">
            <input type="radio" name="radio-btn" id="radio5">
            <div class="slide first">
                <img src="{% static 'imgs/agstate.webp' %}" alt="">
                <!-- <h2>سياسة الإصلاح والإنفتاح في الصين</h2> -->
                <a href="{% url 'the_existing_social_situation' %}">
                    <div class="slide-full-inf">
                        <h2>أهم ملامح الوضع الاجتماعي القائم في اليمن</h2>
                        <span><span style="display: inline;">24 </span>فبراير 2024
                        </span>
                    </div>
                </a>
            </div>
            <div class="slide">
                <img src="{% static 'imgs/y.png' %}" alt="">
                <a href="{% url 'financial_reform_in_yemen' %}">
                    <div class="slide-full-inf">
                        <h2>برامج الإصلاح المالي في الجمهورية اليمنية</h2>
                        <span><span style="display: inline;">13 </span>يناير 2024
                        </span>
                    </div>
                </a>
            </div>
            
            <div class="slide">

                <img src="{% static 'imgs/raw.webp' %}" alt="">
                <!-- <h2>مراحل عملية الإصلاح التشريعي</h2> -->
                <a href="{% url 'rwanda_study' %}">
                    <div class="slide-full-inf">
                        <h2>تجربة رواندا في الإصلاح الإداري</h2>
                        <span><span style="display: inline;">4 </span>مايو 2024
                        </span>
                    </div>
                </a>
            </div>
            <div class="slide">

                <img src="{% static 'imgs/teg.jpg' %}" alt="">
                <!-- <h2>مدخل إلى الحكومة الإلكترونية</h2> -->
                <a href="{% url 'information_and_communications_technology_in_Yemen' %}">
                    <div class="slide-full-inf special-move">
                        <h2>البنية الأساسية لتكنولوجيا المعلومات والاتصالات في اليمن</h2>
                        <span><span style="display: inline;">28 </span>أكتوبر 2023
                        </span>
                    </div>
                </a>
            </div>
            <div class="slide journalImage">
                <img src="{% static 'imgs/New_Slider.png' %}" alt="">
                <a href="{% url 'osus' %}">
                    <div class="slide-full-inf">
                        <h2>دورية أُســـس</h2>
                        <span><span style="display: inline;">8 </span>مارس 2025
                        </span>
                    </div>
                </a>
            </div>
            <div class="navigation-auto">
                <div class="auto-btn1"></div>
                <div class="auto-btn2"></div>
                <div class="auto-btn3"></div>
                <div class="auto-btn4"></div>
                <div class="auto-btn5"></div>
            </div>
        </div>
        <div class="navigation-manual">
            <label for="radio1" class="manual-btn"></label>
            <label for="radio2" class="manual-btn"></label>
            <label for="radio3" class="manual-btn"></label>
            <label for="radio4" class="manual-btn"></label>
            <label for="radio5" class="manual-btn"></label>
        </div>
    </div>
</div>
<div class="container index-articles all-art">
    <a href="{% url 'studies' %}"><h1 class="spe-h1 studies">دراسات وبحوث</h1></a>
    <div class="show-studies-index">
        <div class="show-index-imgs">
            <div class="card">
                <a href="{% url 'firstpage' %}">
                    <img src="{% static 'imgs/manage1.webp' %}" alt="">
                </a>
                <a href="{% url 'firstpage' %}">
                    <div class="text-info-index">
                        <span>2 مارس 2024</span>
                        <p>نشأة الإدارة وتطورها</p>
                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'administrativereform' %}">
                    <img src="{% static 'imgs/repair.jpg' %}" alt="">
                </a>
                <a href="{% url 'administrativereform' %}">
                    <div class="text-info-index">
                        <span>16 مارس 2024</span>
                        <p>الإصلاح الإداري المفهوم والأهداف</p>

                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'reformmethodology' %}">
                    <img src="{% static 'imgs/method1.jpg' %}" alt="">
                </a>
                <a href="{% url 'reformmethodology' %}">
                    <div class="text-info-index">
                        <span>23 مارس 2024</span>
                        <p>منهجية الإصلاح الإداري</p>

                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'legislative_reform_in_the_world' %}">
                    <img src="{% static 'imgs/repair4.jpg' %}" alt="" class="stud">
                </a>
                <a href="{% url 'legislative_reform_in_the_world' %}">
                    <div class="text-info-index">
                        <span>2 نوفمبر 2024</span>
                        <p>تجارب عربية وغربية للإصلاح التشريعي</p>
                    </div>
                </a>
            </div>

            <div class="card">
                <a href="{% url 'studysingapore' %}">
                    <img src="{% static 'imgs/sn.webp' %}" alt="" class="stud">
                </a>
                <a href="{% url 'studysingapore' %}">
                    <div class="text-info-index">
                        <span>27 أبريل 2024</span>
                        <p>تجربة سنغافورا في الإصلاح الإداري</p>

                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'rwanda_study' %}">
                    <img src="{% static 'imgs/raw.webp' %}" alt="" class="stud">
                </a>
                <a href="{% url 'rwanda_study' %}">
                    <div class="text-info-index">
                        <span>4 مايو 2024</span>
                        <p>تجربة رواندا في الإصلاح الإداري</p>
                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'studyOfUS' %}">
                    <img src="{% static 'imgs/US.jpg' %}" alt="" class="stud">
                </a>
                <a href="{% url 'studyOfUS' %}">
                    <div class="text-info-index">
                        <span>13 أبريل 2024</span>
                        <p>تجربة الولايات المتحدة الأمريكية في الإصلاح الإداري</p>

                    </div>
                </a>
            </div>
            <div class="card">
                <a href="{% url 'jor_study' %}">
                    <img src="{% static 'imgs/jor.jpeg' %}" alt="" class="stud">
                </a>
                <a href="{% url 'jor_study' %}">
                    <div class="text-info-index">
                        <span>15 يونيو 2024</span>
                        <p>تجربة المملكة الأردنية الهاشيمة في الإصلاح الإداري</p>
                    </div>
                </a>
            </div>

        </div>
        <a href="{% url 'studies' %}" class="show-all">عرض المزيد</a>
    </div>
</div>
<a href="{% url 'publications' %}"><h1 class="publications in-index with-out">إصدارات المركز</h1></a>
<div class="outside-container">
    <div class="container index-articles">
        <h1 class="publications in-index" style="display: none;">إصدارات المركز</h1>
        <div class="tow-books publications-all">
            <div class="daw">
                <h1 class="spe-h1 index-journals">الدوريات</h1>
                <a href="{% url 'osus' %}">
                    <div class="card">
                        <img src="{% static 'imgs/new_osus.jpg' %}" alt="">
                        <div class="daw-info">
                            <span class="book-span">العدد الأول | مارس 2025</span>
                            <p>دورية أُســـس</p>
                        </div>
                    </div>
                </a>
            </div>
            <div class="daw">
                <h1 class="spe-h1 index-book">الكتب</h1>
                <a href="{% url 'books' %}">
                    <div class="card">
                        <img src="{% static 'imgs/new_book.jpg' %}" alt="">
                        <div class="daw-info">
                            <span class="book-span">مجموعة مؤلفين | ديسمبر 2023</span>
                            <p>رؤية مستقبلية للإصلاح الإداري الشامل في اليمن 2023</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>
<div class="container index-articles hide-in-pc">
    <div class="tow-books">
        <div class="daw">
            <a href="{% url 'infographs' %}"><h1 class="spe-h1 infograph">إنفوجراف</h1></a>
            <div class="card">
                <div class="infogr">
                    <button class="prev" aria-label="السابق">&lt;</button>
                    <a href="{% url 'infographs' %}">
                        <img src="{% static 'imgs/Info-01.png' %}" alt="إنفوجراف">
                    </a>
                    <button class="next" aria-label="التالي">&gt;</button>
                </div>
                <div class="daw-info">
                    <span class="book-span">13 مارس 2025</span>
                    <p class="pod-info-index">أكثر سبع دول إنتاجاً للأدوية في العام 2024</p>
                </div>
            </div>
        </div>
    </div>
    <!-- <a href="{% url 'infographs' %}" class="show-all infograph">عرض المزيد</a> -->

</div>
<a href="{% url 'infographs' %}"><h1 class="publications in-index carousel-title">إنفوجراف</h1></a>
<main>
    <div id="carousel" class="carousel">
        <div id='item_1' class="hideLeft">
            <img src="{% static 'imgs/Info-08.png' %}" alt="إنفوجراف">
            <div class="silder-moving daw-info">
                <span> 13 مارس 2025 </span>
                <p>  أكثر عشر دول تصديرًا للمهاجرين في 2023</p>
            </div>
        </div>
        
        <div id='item_2' class="hideLeft">
            <img src="{% static 'imgs/Info-01.png' %}" alt="إنفوجراف">
            <div class="silder-moving daw-info">
                <span> 13 مارس 2025 </span>
                <p>أكثر سبع دول إنتاجًا للأدوية في العام 2024</p>
            </div>
          </div>
    
        <div id='item_3' class="prevLeftSecond">
            <img src="{% static 'imgs/Info-02.png' %}" alt="image info">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>أكبر عشر دول في احتياطي اليورانيوم</p>
            </div>
        </div>

        <div id='item_4' class="prev">
            <img src="{% static 'imgs/Info-03.png' %}" alt="image info">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>الوزارات الحكومية والاقتصادات الخمس الكبرى</p>
            </div>
        </div>

        <div id='item_5' class="selected">
            <img src="{% static 'imgs/Info-04.png' %}" alt="image info">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>البطالة في الدول العربية</p>
            </div>
        </div>

        <div id='item_6' class="next">
            <img src="{% static 'imgs/Info-05.png' %}" alt="image info">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>كيف يؤثر التعليم على الاقتصاد</p>
            </div>
        </div>

        <div id='item_7' class="nextRightSecond">
            <img src="{% static 'imgs/Info-06.png' %}">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>مساهمة القطاع الخاص في الناتج المحلي الإجمالي 2023</p>
            </div>
        </div>
        
        <div id='item_8' class="hideRight" alt="إنفوجراف">
            <img src="{% static 'imgs/Info-07.png' %}">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>ملوك القطن...أكبر عشر دول منتجة للقطن في العالم 2023</p>
            </div>
        </div>

        <div id='item_9' class="hideRight" alt="إنفوجراف">
            <img src="{% static 'imgs/Info-09.png' %}">
            <div class="silder-moving">
                <span> 13 مارس 2025 </span>
                <p>الضرائب والشركات</p>
            </div>
        </div>
        <div id='item_10' class="hideRight" alt="إنفوجراف">
            <img src="{% static 'imgs/Info-10.png' %}">
            <div class="silder-moving">
                <span> 13 مارس 2025</span>
                <p>التعليم العالي في الوطن العربي</p>
            </div>
        </div>
    </div>
    <div id="carousel-dots" class="carousel-dots"></div>
    <div class="all-rows">
        <div class="arrow-silder left-arrow-silder" id="prev">&larr;</div>
        <div class="arrow-silder right-arrow-silder" id="next">&rarr;</div>
    </div>
</main>
<div class="container index-articles">
    <div class="tow-books">
        <div class="daw">
            <h1 class="spe-h1 pod">داخل الصندوق بودكاست</h1>
            <div class="card pod">
                <img src="{% static 'imgs/PODCAST adv-01.png' %}" alt="">
                <div class="daw-info">
                    <p>قريباً | سلسلة حلقات من إنتاج المركز التأسيسي للدراسات والبحوث تقدم رؤى فاعلة وتجارب إدارية ناجحة
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container index-articles-pod">
    <img src="{% static 'imgs/PODCAST adv 2-01.png' %}" alt="">
</div>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        let intervalTime = 10000; // وقت البداية بين الانتقالات

        function startSlider() {
            counter = 5; // التأكد من البدء من الصورة الأولى
            document.getElementById('radio' + counter).checked = true;

            setTimeout(function sliderTransition() {
                counter--;
                if (counter == 0) {
                    counter = 5; // العودة إلى الصورة الأولى بعد الصورة الأخيرة
                }
                document.getElementById('radio' + counter).checked = true;

                // ضبط الانتقال التالي بنفس الوقت الثابت                
                setTimeout(sliderTransition, intervalTime);
            }, intervalTime);
        }

        // التأكد من تشغيل السلايدر عند تحميل الصفحة        
        window.onload = startSlider;

        const slidess = [
            {
                image: "{% static 'imgs/Info-01.png' %}",
                text: "أكثر سبع دول إنتاجاً للأدوية في العام 2024"
            },
            {
                image: "{% static 'imgs/Info-02.png' %}",
                text: "أكبر عشر دول في احتياطي اليورانيوم"
            },
            {
                image: "{% static 'imgs/Info-03.png' %}",
                text: "الوزارات الحكومية والاقتصادات الخمس الكبرى"
            },
            {
                image: "{% static 'imgs/Info-04.png' %}",
                text: "البطالة في الدول العربية"
            },
            {
                image: "{% static 'imgs/Info-05.png' %}",
                text: "كيف يؤثر التعليم على الاقتصاد"
            },
            {
                image: "{% static 'imgs/Info-06.png' %}",
                text: "مساهمة القطاع الخاص في الناتج المحلي الإجمالي 2023"
            },
            {
                image: "{% static 'imgs/Info-07.png' %}",
                text: "ملوك القطن...أكبر عشر دول منتجة للقطن في العالم 2023"
            },
            {
                image: "{% static 'imgs/Info-08.png' %}",
                text: "أكثر عشر دول تصديرًا للمهاجرين في 2023"
            },
            {
                image: "{% static 'imgs/Info-09.png' %}",
                text: "الضرائب والشركات"
            },
            {
                image: "{% static 'imgs/Info-10.png' %}",
                text: "التعليم العالي في العالم العربي"
            },
            
        ];

        let currentIndex = 0;
        const imgElement = document.querySelector(".infogr img");
        const textElement = document.querySelector(".pod-info-index");
        const prevButton = document.querySelector(".infogr .prev");
        const nextButton = document.querySelector(".infogr .next");

        // تحديث الصورة
        // تحديث الصورة والنص معًا
        function updateSlide(index) {
            imgElement.style.opacity = 0;
            textElement.style.opacity = 0;

            setTimeout(() => {
                imgElement.src = slidess[index].image;
                textElement.textContent = slidess[index].text;

                imgElement.style.opacity = 1;
                textElement.style.opacity = 1;
            }, 0);
        }

        // أزرار التبديل اليدوي
        // أزرار التبديل اليدوي - تعديل فقط الأزرار
        prevButton.addEventListener("click", () => {
            currentIndex = (currentIndex - 1 + slidess.length) % slidess.length;
            updateSlide(currentIndex); // تم تعديل الاسم
        });

        nextButton.addEventListener("click", () => {
            currentIndex = (currentIndex + 1) % slidess.length; // تعديل المصفوفة
            updateSlide(currentIndex); // تم تعديل الاسم
        });

        if (window.innerWidth <= 1200) {
            document.querySelector('.slide.journalImage img').src = "{% static 'imgs/New_Slider_mobile.png' %}";
        }
        const $ = str => document.querySelector(str);
        const $$ = str => document.querySelectorAll(str);

            (function() {
                if (!window.app) {
                    window.app = {};
                }
                app.carousel = {
                    removeClass: function(el, classname='') {
                        if (el) {
                            if (classname === '') {
                                el.className = '';
                            } else {
                                el.classList.remove(classname);
                            }
                            return el;
                        }
                        return;
                    },
                    reorder: function() {
                        let childcnt = $("#carousel").children.length;
                        let childs = $("#carousel").children;

                        for (let j=0; j< childcnt; j++) {
                            childs[j].dataset.pos = j;
                        }
                    },
                    move: function(el) {
                        let selected = el;
                        if (typeof el === "string") {
                            console.log(`got string: ${el}`);
                            selected = (el == "next") ? $(".selected").nextElementSibling : $(".selected").previousElementSibling;
                            console.dir(selected);
                        }
                        let curpos = parseInt(app.selected.dataset.pos);
                        let tgtpos = parseInt(selected.dataset.pos);
                        let cnt = curpos - tgtpos;
                        let dir = (cnt < 0) ? -1 : 1;
                        let shift = Math.abs(cnt);
                        for (let i = 0; i < shift; i++) {
                            let el = (dir == -1) ? $("#carousel").firstElementChild : $("#carousel").lastElementChild;
                            if (dir == -1) {
                                el.dataset.pos = $("#carousel").children.length;
                                $('#carousel').append(el);
                            } else {
                                el.dataset.pos = 0;
                                $('#carousel').prepend(el);
                            }
                            app.carousel.reorder(); 
                        }
                        app.selected = selected;
                        let next = selected.nextElementSibling;
                        var prev = selected.previousElementSibling;
                        var prevSecond = prev ? prev.previousElementSibling : selected.parentElement.lastElementChild;
                        var nextSecond = next ? next.nextElementSibling : selected.parentElement.firstElementChild;
                        selected.className = '';
                        selected.classList.add("selected");
                        app.carousel.removeClass(prev).classList.add('prev');
                        app.carousel.removeClass(next).classList.add('next');
                        app.carousel.removeClass(nextSecond).classList.add("nextRightSecond");
                        app.carousel.removeClass(prevSecond).classList.add("prevLeftSecond");
                        app.carousel.nextAll(nextSecond).forEach(item => { item.className = ''; item.classList.add('hideRight') });
                        app.carousel.prevAll(prevSecond).forEach(item => { item.className = ''; item.classList.add('hideLeft') });

                        // تحديث النقاط بعد التنقل
                        app.carousel.updateDots();

                    },
                    nextAll: function(el) {
                        let els = [];

                        if (el) {
                            while (el = el.nextElementSibling) { els.push(el); }
                        }

                        return els;

                    },
                    prevAll: function(el) {
                        let els = [];

                        if (el) {
                            while (el = el.previousElementSibling) { els.push(el); }
                        }


                        return els;
                    },
                    keypress: function(e) {
                        switch (e.which) {
                            case 37: // left
                                app.carousel.move('prev');
                                break;

                            case 39: // right
                                app.carousel.move('next');
                                break;

                            default:
                                return;
                        }
                        e.preventDefault();
                        return false;
                    },
                    select: function(e) {
                    console.log(`select: ${e}`);
                        let tgt = e.target;
                        while (!tgt.parentElement.classList.contains('carousel')) {
                            tgt = tgt.parentElement;
                        }

                        app.carousel.move(tgt);

                    },
                    previous: function(e) {
                        app.carousel.move('prev');
                    },
                    next: function(e) {
                        app.carousel.move('next');
                    },
                    doDown: function(e) {
                    console.log(`down: ${e.x}`);
                        app.carousel.state.downX = e.x;
                    },
                    doUp: function(e) {
                    console.log(`up: ${e.x}`);
                        let direction = 0,
                            velocity = 0;

                        if (app.carousel.state.downX) {
                            direction = (app.carousel.state.downX > e.x) ? -1 : 1;
                            velocity = app.carousel.state.downX - e.x;

                            if (Math.abs(app.carousel.state.downX - e.x) < 10) {
                                app.carousel.select(e);
                                return false;
                            }
                            if (direction === -1) {
                                app.carousel.move('next');
                            } else {
                                app.carousel.move('prev');
                            }
                            app.carousel.state.downX = 0;
                        }
                    },
                    init: function() {
                        document.addEventListener("keydown", app.carousel.keypress);
                    // $('#carousel').addEventListener("click", app.carousel.select, true);
                        $("#carousel").addEventListener("mousedown", app.carousel.doDown);
                        $("#carousel").addEventListener("touchstart", app.carousel.doDown);
                        $("#carousel").addEventListener("mouseup", app.carousel.doUp);
                        $("#carousel").addEventListener("touchend", app.carousel.doup);

                        app.carousel.reorder();
                        $('#prev').addEventListener("click", app.carousel.previous);
                        $('#next').addEventListener("click", app.carousel.next);

                        // إنشاء النقاط
                        app.carousel.createDots();
                        
                        app.selected = $(".selected");

                    },
                    state: {}

                }

                // إنشاء النقاط
                app.carousel.createDots = function () {
                    const dotsContainer = $("#carousel-dots");
                    dotsContainer.innerHTML = ""; // مسح النقاط القديمة

                    const images = $$("#carousel > div"); // جميع الصور في شريط التمرير
                    images.forEach((_, index) => {
                        const dot = document.createElement("div");
                        dot.dataset.index = index; // تخزين فهرس الصورة
                    //  dot.addEventListener("click", app.carousel.dotClick); // إضافة حدث النقر
                        dotsContainer.appendChild(dot);
                    });

                    app.carousel.updateDots(); // تحديث النقطة المحددة
                };

                // تحديث النقطة المحددة
                app.carousel.updateDots = function () {
                    const selectedImage = $(".selected");
                    const selectedId = selectedImage.id; // قراءة id الخاص بالعنصر المحدد
                
                    const dots = $$("#carousel-dots div");
                    dots.forEach(dot => {
                        const dotIndex = parseInt(dot.dataset.index);
                        const elementId = `item_${dotIndex + 1}`; // حساب id بناءً على فهرس النقطة
                        dot.classList.toggle("active", elementId === selectedId); // تحديث النقطة المحددة
                    });
                };

                // التعامل مع النقر على النقاط
                app.carousel.dotClick = function (e) {
                    const targetIndex = parseInt(e.target.dataset.index);
                    const targetId = `item_${targetIndex + 1}`; // حساب id بناءً على فهرس النقطة
                
                    const selectedImage = $(".selected");
                    const currentId = selectedImage.id;
                
                    // تحديد الاتجاه بناءً على الفرق بين الـ id الحالي والمستهدف
                    const direction = targetIndex > parseInt(currentId.split("_")[1] - 1) ? "next" : "prev";
                    const steps = Math.abs(targetIndex - (parseInt(currentId.split("_")[1]) - 1));
                
                    for (let i = 0; i < steps; i++) {
                        app.carousel.move(direction);
                    }
                
                    // تحديث النقاط بعد النقر
                    app.carousel.updateDots();
                };

                app.carousel.init();
            })();
    });
</script>
{% endblock %}